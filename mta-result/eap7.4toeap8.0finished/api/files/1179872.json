{"id":"1179872","content":"package com.redhat.coolstore.service;\r\n\r\nimport com.redhat.coolstore.model.Order;\r\nimport com.redhat.coolstore.model.OrderItem;\r\nimport com.redhat.coolstore.utils.Transformers;\r\nimport jakarta.ejb.ActivationConfigProperty;\r\nimport jakarta.ejb.MessageDriven;\r\nimport jakarta.inject.Inject;\r\nimport jakarta.jms.JMSException;\r\nimport jakarta.jms.Message;\r\nimport jakarta.jms.MessageListener;\r\nimport jakarta.jms.TextMessage;\r\nimport java.util.logging.Logger;\r\n\r\n@MessageDriven(\r\n   name = \"OrderServiceMDB\",\r\n   activationConfig = {@ActivationConfigProperty(\r\n   propertyName = \"destinationLookup\",\r\n   propertyValue = \"topic/orders\"\r\n), @ActivationConfigProperty(\r\n   propertyName = \"destinationType\",\r\n   propertyValue = \"jakarta.jms.Topic\"\r\n), @ActivationConfigProperty(\r\n   propertyName = \"acknowledgeMode\",\r\n   propertyValue = \"Auto-acknowledge\"\r\n)}\r\n)\r\npublic class OrderServiceMDB implements MessageListener {\r\n   @Inject\r\n   OrderService orderService;\r\n   @Inject\r\n   CatalogService catalogService;\r\n   private Logger log = Logger.getLogger(OrderServiceMDB.class.getName());\r\n\r\n   public void onMessage(Message rcvMessage) {\r\n      TextMessage msg = null;\r\n\r\n      try {\r\n         if (rcvMessage instanceof TextMessage) {\r\n            msg = (TextMessage)rcvMessage;\r\n            String orderStr = (String)msg.getBody(String.class);\r\n            this.log.info(orderStr);\r\n            Order order = Transformers.jsonToOrder(orderStr);\r\n            this.log.info(order);\r\n            this.orderService.save(order);\r\n            order.getItemList().forEach(this);\r\n         }\r\n\r\n      } catch (JMSException var5) {\r\n         throw new RuntimeException(var5);\r\n      }\r\n   }\r\n\r\n   // $FF: synthetic method\r\n   private void lambda$onMessage$0(OrderItem orderItem) {\r\n      this.catalogService.updateInventoryItems(orderItem.getProductId(), orderItem.getQuantity());\r\n   }\r\n}\r\n"}